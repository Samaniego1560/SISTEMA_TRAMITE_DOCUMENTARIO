<div class="w-full h-full flex flex-col">
  <div class="overflow-y-auto w-full h-full flex flex-col p-8 gap-8">
    <!--Información del paciente-->
    <app-basic-information-patient
      [showVaccinesRequired]="false"
      [infoPatientDni]="infoPatientDni"
      (patientFound)="patient.set($event)"
    />

    <div class="flex">
      <div class="i-field">
        <label>Fecha atención</label>
        <input type="datetime-local" [value]="attentionDate()" [disabled]="infoConsultation" (change)="changeAttentionDate($event)">
      </div>
    </div>

    <div class="flex flex-col gap-4">
      <button class="w-full flex items-center gap-2 t-h2 text-brand-2 font-bold">
        <div class="cursor-pointer">
          <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13 6L8 11L3 6" stroke="#1ABB9C" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round"/>
          </svg>
        </div>
        <span>Servicios</span>
      </button>
      <div class="w-full flex flex-col gap-4">
        @if (!infoPatientDni) {
          <div class="actions w-full flex item-end gap-2">
            <div class="i-field w-full max-w-[160px]">
              <label>Tipo de servicio</label>
              <select #select [disabled]="!patient()" class="{{patient()? 'cursor-pointer' : 'cursor-default'}}"
                      [(ngModel)]="examSelected">
                <option value="">Seleccione una servicio</option>
                @for (typeExam of typesServices; track $index) {
                  <option [value]="typeExam">{{ typeExam | titlecase }}</option>
                }
              </select>
            </div>
            <button type="submit"
                    class="{{patient() && examSelected() ? 'cursor-pointer' : 'cursor-default'}} {{patient() && examSelected() ? 'b-secondary' : 'b-disabled'}} self-end h-10"
                    (click)="onAddExam(select.value)" [disabled]="!patient() || !examSelected()">
              <div>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                     stroke="currentColor" class="size-5">
                  <path stroke-linecap="round" stroke-linejoin="round"
                        d="M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
              </div>
              <span>Agregar servicio</span>
            </button>
          </div>
        }

        @for (exam of listExams; track exam) {
          @if (exam === 'consulta') {
            <app-integral-attention-form
              #formExams
              [infoData]="infoConsultation?.consulta"
              [touched]="touchedForms()"
              (deleteForm)="onDeleteExam('consulta')"
            />
          }
          @if (exam === 'examen') {
            <app-oral-exam-form
              #formExams
              [infoData]="infoConsultation?.examen_bucal"
              [touched]="touchedForms()"
              (deleteForm)="onDeleteExam('examen')"
            />
          }
          @if (exam === 'procedimiento') {
            <app-procedure-form
              #formExams
              [dniPatient]="patient()?.dni!"
              [infoData]="infoConsultation?.procedimiento"
              [touched]="touchedForms()"
              (deleteForm)="onDeleteExam('procedimiento')"
            />
          }
        }
      </div>
    </div>

  </div>

  <div class="justify-end items-center gap-4 flex px-8 py-4 border-t rounded-b-lg border-gray-200 w-full">
    <button type="button" (click)="cancel.emit()" class="b-normal">
      @if (isModeCreation) {
        Cancelar
      } @else {
        Salir
      }
    </button>
    @if (isModeCreation) {
      <button type="button" class="b-primary" (click)="onSaveForm()">
        Guardar
      </button>
    }
  </div>
</div>
