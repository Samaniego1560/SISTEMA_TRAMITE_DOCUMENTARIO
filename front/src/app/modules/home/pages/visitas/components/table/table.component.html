<div class="mb-4 space-y-4">
  <div
    *ngIf="filters && filters.length > 0"
    class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end"
  >
    <div *ngFor="let filter of filters" class="relative">
      <label
        [for]="'filter-' + filter.field"
        class="block text-sm font-medium text-gray-700 mb-1"
        >{{ filter.label }}</label
      >
      <select
        [id]="'filter-' + filter.field"
        [(ngModel)]="activeFilters[filter.field]"
        (change)="onFilterChange(filter.field, activeFilters[filter.field])"
        [disabled]="isFilterDisabled(filter)"
        class="block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
      >
        <option value="">Todos</option>
        <option
          *ngFor="let option of getFilterOptions(filter)"
          [value]="option.value"
        >
          {{ option.label }}
        </option>
      </select>
    </div>
    <div class="relative">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="applyFilters()"
        placeholder="Buscar..."
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      />
      <div
        class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
      >
        <svg
          class="w-5 h-5 text-gray-400"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          ></path>
        </svg>
      </div>
    </div>
  </div>
</div>

<div class="overflow-x-auto bg-white rounded-lg shadow">
  <table class="min-w-full divide-y divide-gray-200">
    <thead class="bg-gray-50">
      <tr>
        <th
          scope="col"
          class="py-3.5 px-4 text-sm font-normal text-center rtl:text-right text-gray-500 w-16"
        >
          N°
        </th>
        <ng-container *ngFor="let column of columns">
          <th
            scope="col"
            class="py-3.5 px-4 text-sm font-normal text-left rtl:text-right text-gray-500"
          >
            <button class="flex gap-x-3 focus:outline-none">
              <span>{{ column.header }}</span>
              
            </button>
          </th>
        </ng-container>
        <th
          scope="col"
          class="px-12 py-3.5 text-sm font-normal text-center rtl:text-right text-gray-500"
        >
          Acciones
        </th>
      </tr>
    </thead>    
    <tbody class="bg-white divide-y divide-gray-200">      
      <tr *ngFor="let item of paginatedData; let i = index" class="hover:bg-gray-50">
        <td class="px-4 py-4 text-sm font-medium whitespace-nowrap text-center">
          <span class="font-medium text-slate-600">
            {{ (currentPage - 1) * itemsPerPage + i + 1 }}
          </span>
        </td>
        <ng-container *ngFor="let column of columns">
          <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
            <div>
              <h2 class="font-medium text-slate-500" 
                  *ngIf="!column.field.includes('_badge')"
              >{{ item[column.field] }}</h2>
              <div 
                *ngIf="column.field.includes('_badge')"
                [innerHTML]="item[column.field]"
                class="flex justify-start"
              ></div>
            </div>
          </td>
        </ng-container>        
        <td class="px-12 py-4 text-sm font-medium whitespace-nowrap flex gap-4 justify-center">
          <ng-container *ngFor="let action of (item.actions || actions)">
            <div 
              class="cursor-pointer flex justify-center" 
              [title]="action.label"
              (click)="onActionClick(action.action, item)"
            >
              <svg 
                *ngIf="action.icon === 'trash'"
                xmlns="http://www.w3.org/2000/svg" 
                class="w-6 h-6 text-slate-500" 
                viewBox="0 0 512 512"
              >
                <path 
                  d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320"
                  fill="none"
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="32"
                />
                <path 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-miterlimit="10" 
                  stroke-width="32"
                  d="M80 112h352"
                />
                <path
                  d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224"
                  fill="none" 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round"
                  stroke-width="32"
                />
              </svg>
              <svg 
                *ngIf="action.icon === 'pencil'"
                xmlns="http://www.w3.org/2000/svg" 
                class="w-6 h-6 text-slate-500" 
                viewBox="0 0 512 512"
              >
                <path 
                  d="M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48"
                  fill="none" 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round"
                  stroke-width="32"
                />
                <path
                  d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z"
                />
              </svg>              <svg 
                *ngIf="action.icon === 'eye'"
                xmlns="http://www.w3.org/2000/svg" 
                class="w-6 h-6 text-slate-500" 
                viewBox="0 0 512 512"
              >
                <path 
                  d="M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 00-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 000-17.47C428.89 172.28 347.8 112 255.66 112z" 
                  fill="none" 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="32"
                />
                <circle 
                  cx="256" 
                  cy="256" 
                  r="80" 
                  fill="none" 
                  stroke="currentColor" 
                  stroke-miterlimit="10" 
                  stroke-width="32"
                />
              </svg>
              <svg 
                *ngIf="action.icon === 'plus'"
                xmlns="http://www.w3.org/2000/svg" 
                class="w-6 h-6 text-slate-500" 
                viewBox="0 0 512 512"
              >
                <path 
                  fill="none" 
                  stroke="currentColor" 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="32" 
                  d="M256 112v288M400 256H112"
                />
              </svg>
            </div>
          </ng-container>
        </td>
      </tr>     
      <tr *ngIf="paginatedData.length === 0">
        <td
          [attr.colspan]="columns.length + 2"
          class="px-4 py-4 text-center text-sm font-medium text-slate-500"
        >
          No se encontraron resultados
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div
  *ngIf="totalPages > 1"
  class="flex items-center justify-between px-4 py-3 bg-white  sm:px-6 mt-4"
>
  <div>
    <span class="text-sm text-gray-700">
      Página 
      <span class="font-medium">{{ currentPage }} </span>
       de 
       <span class="font-medium">{{ totalPages }} </span>
    </span>
  </div>
  <div class="flex items-center space-x-4">
    <button
      [disabled]="currentPage === 1"
      (click)="onPageChange(currentPage - 1)"
      class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      Anterior
    </button>
    <button
      [disabled]="currentPage === totalPages"
      (click)="onPageChange(currentPage + 1)"
      class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
    >
      Siguiente
      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>
</div>
