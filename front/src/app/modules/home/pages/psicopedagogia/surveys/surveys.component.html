<div class="p-6 bg-gray-100 w-full h-full">
    <div class="mb-6 flex justify-between items-center px-6 py-6 border-b border-gray-300">
        <h2 class="text-2xl font-bold text-gray-900">GESTIÓN DE ENCUESTAS S.R.Q</h2>
        <button class="text-white px-4 py-2 rounded-lg hover:bg-blue-700" style="background-color: #0F75BC;"
            (click)="openModal()">Nueva Encuesta</button>
    </div>
    <app-toast></app-toast>
    <div class="bg-white shadow-lg rounded-lg p-6">
        <div *ngIf="surveys.length == 0 && !isLoading">
            <div class="flex flex-col items-center justify-center w-full">
                <p class="text-gray-600 text-lg font-medium">No hay resultados</p>
                <p class="text-gray-500 text-sm">Por favor crea una nueva encuesta.</p>
            </div>
        </div>
        <table *ngIf="surveys.length != 0" class="divide-y divide-gray-200 overflow-x-scroll table-fixed w-full">
            <thead class="bg-gray-200 ">
                <tr>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha de Inicio</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha de Fin</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                </tr>
            </thead>
            
            <tbody *ngIf="isLoading === false" class="bg-white divide-y divide-gray-200 text-xs">
                <tr *ngFor="let survey of surveys" class="bg-white divide-y divide-gray-200 text-xs">
                    <td class="px-4 py-2 whitespace-wrap text-sm text-gray-900">{{ survey.name }}</td>
                    <td class="px-4 py-2 whitespace-wrap text-sm text-gray-900">{{ survey.description }}</td>
                    <td class="px-4 py-2 whitespace-wrap text-sm text-gray-900">{{ survey.startDate }}</td>
                    <td class="px-4 py-2 whitespace-wrap text-sm text-gray-900">{{ survey.endDate }}</td>
                    <td class="px-4 py-2 whitespace-wrap">
                        <span [ngClass]="{
                            'bg-green-100 text-green-800': survey.status === 'activa',
                            'bg-red-100 text-red-600': survey.status === 'inactiva'
                          }"  class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">{{ survey.status }}</span>
                    </td>
                    <td class="px-4 py-2 whitespace-wrap text-sm text-gray-900 ">
                        <button class="bg-blue-300 text-white px-3 py-2 rounded hover:bg-blue-400 mr-2" (click)="editSurvey(survey)">
                            Editar ✏️
                        </button>
                        
                    </td>
                </tr>
                
            </tbody>    
            
        
        </table>
        <div *ngIf="isLoading" class="w-full">
            <div class="flex items-center justify-center w-full">
                <svg class="w-12 h-12 text-green-500 animate-spin" fill="none" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                        d="M4 12a8 8 0 018-8v8H4z"></path>
                </svg>
                <p class="text-gray-500 mt-2 text-lg">Cargando...</p>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div *ngIf="showModal" class="fixed inset-0 flex items-start justify-center bg-gray-900 bg-opacity-75 p-10 z-10">
        <div class="bg-white p-6 rounded-lg shadow-lg w-1/2">
            <h2 class="text-xl font-bold mb-4">{{ editMode ? 'EDITAR ENCUESTA' : 'NUEVA ENCUESTA' }}</h2>
            <form [formGroup]="surveyForm" (ngSubmit)="addSurvey()">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 font-medium mb-1">Nombre</label>
                        <input formControlName="name" type="text" class="border p-3 rounded w-full bg-gray-200" />
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-1">Descripción</label>
                        <input formControlName="description" type="text" placeholder="Descripción"
                            class="border p-3 rounded w-full" />
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-1">Fecha de Inicio</label>
                        <input formControlName="startDate" type="date" class="border p-3 rounded w-full" />
                    </div>
                    <div>
                        <label class="block text-gray-700 font-medium mb-1">Fecha de Fin</label>
                        <input formControlName="endDate" type="date" class="border p-3 rounded w-full" />
                    </div>
                </div>
                <div class="mt-6 flex justify-end">
                    <button type="button" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 mr-2"
                        (click)="closeModal()">Cancelar</button>
                    <button type="submit" class="text-white px-4 py-2 rounded-lg hover:bg-green-700"
                        style="background: #1ABB9C;">{{ editMode ? 'Actualizar' : 'Guardar' }}</button>
                </div>
            </form>
        </div>
    </div>
</div>