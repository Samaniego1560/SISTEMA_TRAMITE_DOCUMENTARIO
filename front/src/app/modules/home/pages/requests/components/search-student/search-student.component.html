<div
  class="px-8 py-12 overflow-auto w-full pb-24 space-y-4"
  style="height: calc(100vh - 64px)"
>
  <div class="w-full flex justify-between">
    <div>
      <button
        (click)="back()"
        class="rounded bg-emerald-500 text-white px-2 py-1 text-sm hover:bg-emerald-400 flex gap-1 items-center text-nowrap"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
             stroke="currentColor" class="w-8 h-8 rtl:-scale-x-100 cursor-pointer" (click)="back()">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18"/>
        </svg>
        Atras
      </button>
    </div>
    <div class="text-slate-500 font-bold text-2xl text-center w-full">
      <span>Buscar estudiante</span>
    </div>
  </div>

  <div>
    <div class="w-1/2 inline-flex overflow-hidden bg-white divide-x rounded-lg rtl:flex-row-reverse">
      <input
        type="text"
        class="w-full px-4 py-2 text-sm text-gray-900 placeholder-gray-500 focus:outline-none border"
        placeholder="Buscar"
        [(ngModel)]="dni"
        name="dni"
      />
      <button
        class="flex items-center justify-center px-4 text-gray-500 bg-gray-100 hover:bg-gray-200 focus:outline-none"
        (click)="searchStudent(dni)"
      >
        <svg
          class="w-5 h-5"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="11" cy="11" r="8"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
      </button>
    </div>
  </div>

  @if (studentFileReport && studentFileReport.announcements?.length) {

    <div class="container mx-auto px-4 py-8 max-w-7xl">
      <!-- Header Section -->
      <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-6">
        <h1 class="text-3xl font-bold text-gray-800">{{studentFileReport.title}} {{studentFileReport.year}}</h1>

        <div class="profile flex flex-col items-center justify-center space-y-3">
          <img
            [src]="urlProfile || 'https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png'"
            alt="Profile Image"
            class="w-24 h-24 rounded-full border-2 border-gray-300 shadow-lg object-cover hover:border-blue-500 transition-colors">
          <h2 class="text-lg font-semibold text-gray-700">{{dni}}</h2>
          <p class="text-sm text-gray-500 hover:text-blue-500">unas.edu.pe</p>
        </div>
      </div>

      <!-- First Section -->
      <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <label class="block text-xl font-semibold text-gray-700 mb-4">
          {{studentFileReport.first_section.description}}
        </label>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          @for(requirement of studentFileReport.first_section.requirements; track requirement;) {
            @if(requirement.name !== 'photo-profile') {
              <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-600">{{requirement.name}}</label>
                <input
                  [value]="requirement.value"
                  disabled
                  class="w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-md text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-75">
              </div>
            }
          }
        </div>
      </div>

      <!-- Announcements Sections -->
      @for(announcement of studentFileReport.announcements; track announcement;) {
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
          <h3 class="text-xl font-semibold text-gray-800 mb-6">{{announcement.name}}</h3>

          @for(section of announcement.details_requests; track section;) {
            <div class="mb-6 last:mb-0">
              <label class="block text-lg font-medium text-gray-700 mb-4">
                {{section.description}}
              </label>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                @for(requirement of section.requirements; track requirement;) {
                  <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-600">{{requirement.name}}</label>
                    <input
                      [value]="getValues(requirement)"
                      disabled
                      class="w-full px-4 py-2 bg-gray-50 border border-gray-200 rounded-md text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-75">
                  </div>
                }
              </div>
            </div>
          }
        </div>
      }
    </div>

    <div>
      <button
        (click)="downloadAsPDF()"
        class="rounded bg-emerald-500 text-white px-2 py-1 text-sm hover:bg-emerald-400 flex gap-1 items-center text-nowrap"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="text-white w-6 h-6"
          viewBox="0 0 512 512"
        >
          <path
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="48"
            d="M268 112l144 144-144 144M392 256H100"
          />
        </svg>
        Imprimir
      </button>
    </div>
  }
</div>

<app-toast></app-toast>
<app-block-ui [show]="isLoading"></app-block-ui>
